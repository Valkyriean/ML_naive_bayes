Please running the .ipynb file in order to recreate the results. The code in question 1 will utilze the code above to do the training and prediction along with evaluation. 
The main.py file is a backup of .ipynb file that contains the same code. Please only use main.py if .ipynb file is not working.